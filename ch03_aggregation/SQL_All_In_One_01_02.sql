-- SQL/DB ALL IN ONE 01
-- MAY 3, 2021

-- #01. GROUP BY

-- Syntax
SELECT 
	COLUMN_1
	, AGGREGATIONAL_FUNC(COLUMN_2)
FROM 
	TABLE_NAME
GROUP BY
	COLUMN_1
	;
	

-- Ex#01. Simple group by
SELECT
	CUSTOMER_ID
FROM 
	PAYMENT
GROUP BY 
	CUSTOMER_ID -- OMITTING SAME VALUES
	;
	
-- Ex#02. SUM + SORTING wit GROUP BY
SELECT
	  CUSTOMER_ID
	, SUM(AMOUNT) AS AMOUNT_SUM
FROM
	PAYMENT
GROUP BY 
	CUSTOMER_ID
ORDER BY 
	SUM(AMOUNT) desc
	;

-- Ex#03 COUNT with GROUP BY
SELECT
	STAFF_ID
	, COUNT(PAYMENT_ID) AS COUNT
FROM 
	PAYMENT
GROUP BY 
	STAFF_ID
	;

-- #02. HAVING
-- GROUP BY MUST BE WRTITTEN RIGHT AT THE BACK OF 
-- FROM OR WHERE.
-- Syntax
SELECT 
	COLUMN_1
	, FUNCTION(COLUMN_2)
FROM
	TABLE_NAME
GROUP BY
	COLUMN_1 HAVING CONDITION;
	
-- Ex#01. GROUP BY + HAVING
SELECT
	  CUSTOMER_ID
	, SUM(AMOUNT) AS AMOUNT_SUM
FROM
	PAYMENT
GROUP BY 
	CUSTOMER_ID HAVING SUM(AMOUNT) > 200
	;
	
